<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <link rel="stylesheet" href="../../css/mui.min.css" />
    <link rel="stylesheet" href="../../css/common.css" />
    <style>
    	.logo{vertical-align: middle;width: 25px;}
    	.mui-bar .mui-icon{font-size: 34px;top: -2px;}
    	.mui-bar-nav~.mui-content{padding-top: 60px;}
    	.mui-content{padding: 15px 25px;box-sizing: border-box;}
    	.fm{margin-top: 15px;}
    	.paly{position: fixed;width: 100%;bottom: 0;left: 0;padding-bottom: 10px;}
    	.tp1{width: 33px;}
    	.tp2{width: 25px;color: #7D7D7C;}
    	.tp3{width: 45px;position: relative;top: -8px;}
    	.jdt{padding: 5px 6%;font-size: 12px;}
    	.mui-progressbar{top: 9px;}
    	.time{width: 25px;color: #7D7D7C;}
    	.mui-scroll-wrapper{bottom: 155px;height: 80px;top: auto;}
    	.mui-scroll>div{margin-bottom: 5px;text-align: center;font-size: 15px;color: #757574;}
    </style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
	    <a class="mui-action-back mui-icon mui-icon-arrowdown"></a>
	    <h1 class="mui-title">粉红色的回忆</h1>
	    <a class="mui-pull-right"><img src="../../image/share.png"/></a>
	</header>
	<div class="mui-content">
		<div class="mui-text-center" style="color: #4C4949;"><div id="marquee"></div></div>
		<div class="fm"><img class="width-100" src="../../image/person.png"/></div>
		<div class="mui-scroll-wrapper">
		    <div class="mui-scroll">
		        <!--<div>我是歌词</div>
		        <div>我是歌词</div>
		        <div>我是歌词</div>
		        <div>我是歌词</div>-->
		    </div>
		</div>
		<div class="paly">
			<div class="flex just-around">
				<div><img class="tp1" src="../../image/Collection2.png"/></div>
				<div><img class="tp1" src="../../image/downlowd.png"/></div>
				<div><img class="tp1" src="../../image/comment.png"/></div>
				<div><img class="tp1" src="../../image/morn.png"/></div>
			</div>
			<div class="flex jdt">
				<div class="time time1" style="margin-right: 4px;">0:00</div>
				<div class="flex1">
					<div id="demo1" class="mui-progressbar">
						<span></span>
					</div>
				</div>
				<div class="time time2" style="margin-left: 4px;">0:00</div>
			</div>
			<div class="flex just-around mt-15">
				<div><img class="tp2" src="../../image/round.png"/></div>
				<div><img class="tp2 prev" src="../../image/thelast.png"/></div>
				<div><img class="tp3" title="false" src="../../image/play1.png"/></div>
				<div><img class="tp2 next" src="../../image/next.png"/></div>
				<div><img class="tp2" src="../../image/sheet.png"/></div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="../../js/mui.min.js" ></script>
<script type="text/javascript" src="../../js/common.js" ></script>
<script type="text/javascript" charset="utf-8">
	document.addEventListener("plusready", onPlusReady, false); 
	function onPlusReady(){
		var mp3List=[
			{title:'粉红色的回忆',url:'../../mp3/fhsdhy.mp3',name:'王宝强、刘昊然、肖央、潘粤明、小沈阳、张子枫'},
			{title:'该',url:'../../mp3/gai.mp3',name:'曲肖冰'},
			{title:'在心里从此永远有个你',url:'../../mp3/zxliccygn.mp3',name:'办桌二人组'},
		];
		var page=localStorage.page || 0;
		var num,miao,time,n,m,player=null;
		var tp3=document.querySelector(".tp3");
		var mp3={
			init:function(){
				player = plus.audio.createPlayer(mp3List[page].url);
				num = player.getDuration();//获取音频总长度number
				miao=100/num;
				time=null;
				n=0;m=0;
				mui("#demo1").progressbar({progress:0}).show();
				document.querySelector(".time2").innerText=formatSeconds(num);
				tp3.title="false";
				if(mp3List[page].name.length>19){
					document.querySelector("#marquee").innerHTML='<marquee>'+mp3List[page].name+'</marquee>';
				}else{
					document.querySelector("#marquee").innerText=mp3List[page].name;
				}
				document.querySelector(".mui-title").innerText=mp3List[page].title;
			},
			toPlay:function(){
				tp3.src="../../image/play3.png";
				player.play(function(){
					tp3.src="../../image/play1.png";
					player.stop();
					tp3.title="false";
					mp3.next();
				},function (e) {
					mui.toast("播放出错"+e.message);
				});
				time=setInterval(function(){
					n++;
					if(n<10){
						document.querySelector(".time1").innerText="0:0"+n;
					}else if(n>=10&&n<=60){
						document.querySelector(".time1").innerText="0:"+n;
					}else{
						document.querySelector(".time1").innerText=formatSeconds(n);
					}
					m+=miao;
					mui("#demo1").progressbar().setProgress(m);
				},1000)
				tp3.title="true";
			},
			next:function(){
				page++;
				if(page>mp3List.length-1){
					page=0;
				}
				localStorage.page=page;
				player.stop();
				clearInterval(time);
				this.init();
				this.toPlay();
			},
			prev:function(){
				page--;
				if(page<0){
					page=mp3List.length-1;
				}
				localStorage.page=page;
				player.stop();
				clearInterval(time);
				this.init();
				this.toPlay();
			}
		}
		mp3.init();
		mui("div").on("tap",".prev",function(e){
			e.stopPropagation();
			mp3.prev();
		})
		mui("div").on("tap",".next",function(e){
			e.stopPropagation();
			mp3.next();
		})
		mui("div").on("tap",".tp3",function(e){
			e.stopPropagation();
			if(tp3.title=="true"){
				tp3.src="../../image/play1.png";
				clearInterval(time);
				player.pause();
				tp3.title="false";
			}else{
				mp3.toPlay();
			}
		})
		function formatSeconds(value) {
	        var secondTime = parseInt(value);// 秒
	        var minuteTime = 0;// 分
	        var hourTime = 0;// 小时
	        if(secondTime > 60) {//如果秒数大于60，将秒数转换成整数
	            //获取分钟，除以60取整数，得到整数分钟
	            minuteTime = parseInt(secondTime / 60);
	            //获取秒数，秒数取佘，得到整数秒数
	            secondTime = parseInt(secondTime % 60);
	            //如果分钟大于60，将分钟转换成小时
	            if(minuteTime > 60) {
	                //获取小时，获取分钟除以60，得到整数小时
	                hourTime = parseInt(minuteTime / 60);
	                //获取小时后取佘的分，获取分钟除以60取佘的分
	                minuteTime = parseInt(minuteTime % 60);
	            }
	        }
	        var result = "" + parseInt(secondTime);
	        if(minuteTime > 0) {
	            result = "" + parseInt(minuteTime) + ":" + result;
	        }
	        return result;
	    }
		mui('.mui-scroll-wrapper').scroll({
			indicators: false, //是否显示滚动条
		});
		mui("header").on("tap",".mui-action-back",function(e){
			e.stopPropagation();
		　　plus.webview.hide(plus.webview.currentWebview(),"fade-out");
		})
	}
</script>
</html>